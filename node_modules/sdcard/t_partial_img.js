var tessel = require('tessel'),
    builtin_fs = require('fs'),
    sdlib = require("./");

builtin_fs.readFile("./sdcard-issues-21-complete.jpg", function (e,d) {
  if (e) throw e;
  else console.log("Opened file", d.length, "bytes");
  
  sdlib.use(tessel.port['A'], {getFilesystems:true}, function (e,arr) {
      if (e) throw e;
      else card_fs = arr[0];
      console.log("Got filesystem.");
      card_fs.writeFile("sdcard-issues-21-copy_"+Date.now()+".jpg", d, function (e) {
          if (e) throw e;
          else console.log("Wrote file.");
      });
  });
});